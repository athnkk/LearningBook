# gdb
- [gdb](#1)
- [gdb 调试coredump文件过程](#2)
- [gdb多线程调试](#3)
- [cmake配置gdb](#4)
- [gcc编译选项](#5)


## <a id="1">gdb</a>
```cpp
对C/C++程序的调试，需要在编译前就加上-g选项:
$g++ -g hello.cpp -o hello
调试core文件(core是程序非法执行后core dump后产生的文件):
$gdb <program> <core dump file>
$gdb program core.11127

运行
run：简记为 r ，其作用是运行程序，当遇到断点后，程序会在断点处停止运行，等待用户输入下一步的命令。
continue （简写c ）：继续执行，到下一个断点处（或运行结束）
next：（简写 n），单步跟踪程序，当遇到函数调用时，也不进入此函数体；此命令同 step 的主要区别是，step 遇到用户自定义的函数，将步进到函数中去运行，而 next 则直接调用函数，不会进入到函数体内。
step（简写s）：单步调试如果有函数调用，则进入函数；与命令n不同，n是不进入调用的函数的
until：当你厌倦了在一个循环体内单步跟踪时，这个命令可以运行程序直到退出循环体。
until+行号： 运行至某行，不仅仅用来跳出循环
finish： 运行程序，直到当前函数完成返回，并打印函数返回时的堆栈地址和返回值及参数值等信息。
call 函数(参数)：调用程序中可见的函数，并传递“参数”，如：call gdb_test(55)
quit：简记为 q ，退出gdb
设置断点
break n （简写b n）:在第n行处设置断点
（可以带上代码路径和代码名称： b OAGUPDATE.cpp:578）
b fn1 if a＞b：条件断点设置
break func（break缩写为b）：在函数func()的入口处设置断点，如：break cb_button
delete 断点号n：删除第n个断点
disable 断点号n：暂停第n个断点
enable 断点号n：开启第n个断点
clear 行号n：清除第n行的断点
info b （info breakpoints） ：显示当前程序的断点设置情况
delete breakpoints：清除所有断点：
查看源代码
list ：简记为 l ，其作用就是列出程序的源代码，默认每次显示10行。
list 行号：将显示当前文件以“行号”为中心的前后10行代码，如：list 12
list 函数名：将显示“函数名”所在函数的源代码，如：list main
list ：不带参数，将接着上一次 list 命令的，输出下边的内容。
打印表达式
print 表达式：简记为 p ，其中“表达式”可以是任何当前正在被测试程序的有效表达式，比如当前正在调试C语言的程序，那么“表达式”可以是任何C语言的有效表达式，包括数字，变量甚至是函数调用。
print a：将显示整数 a 的值
print ++a：将把 a 中的值加1,并显示出来
print name：将显示字符串 name 的值
print gdb_test(22)：将以整数22作为参数调用 gdb_test() 函数
print gdb_test(a)：将以变量 a 作为参数调用 gdb_test() 函数
display 表达式：在单步运行时将非常有用，使用display命令设置一个表达式后，它将在每次单步进行指令后，紧接着输出被设置的表达式及值。如： display a
watch 表达式：设置一个监视点，一旦被监视的“表达式”的值改变，gdb将强行终止正在被调试的程序。如： watch a
whatis ：查询变量或函数
info function： 查询函数
扩展info locals： 显示当前堆栈页的所有变量
查询运行信息
where/bt ：当前运行的堆栈列表；
bt backtrace 显示当前调用堆栈
up/down 改变堆栈显示的深度
set args 参数:指定运行时的参数
show args：查看设置好的参数
info program： 来查看程序的是否在运行，进程号，被暂停的原因。
分割窗口
layout：用于分割窗口，可以一边查看代码，一边测试：
layout src：显示源代码窗口
layout asm：显示反汇编窗口
layout regs：显示源代码/反汇编和CPU寄存器窗口
layout split：显示源代码和反汇编窗口
Ctrl + L：刷新窗口
```

## <a id="2">gdb 调试coredump文件过程</a>
```cpp
gdb 调试coredump文件过程：
第一步：首先需要一个进程的coredump文件，怎么搞出coredump文件呢？
1、 ps -fax|grep                 进程名称 找到进程的pid
2、gdb -p pid                     调试进程
3、gcore coredump名称        则生成core文件
第二步：找出coredump文件的应用程序
1、gdb -c corefile   使用gdb调试core文件
2、info auxv          索引31对应的是core文件的应用程序
第三部：gdb使用应用程序调试coredump文件
gdb  coredump应用程序  coredump文件     调试coredump文件 
通过以上三步就可以调试coredump文件了

通过以下命令调试coredump文件
info threads 显示所有线程
bt 显示线程堆栈信息
thread thread_num   切换线程
frame num  切换栈
info r 显示当前帧的寄存器信息 （每一帧的寄存器信息都是不相同的）
 
readelf应用coredump
readelf -h 读取coredump文件头
readelf -wl 读取应用程序debug_line
readelf -wf 读取应用程序fde和cie信息
参考链接：https://www.cnblogs.com/wangjian8888/p/5950912.html
```


## <a id="3">gdb多线程调试</a>
参考连接：    
1.线程的查看以及利用gdb调试多线程      
https://blog.csdn.net/zhangye3017/article/details/80382496    

```c++
ps aux|grep a.out   //查看当前运行的进程

ps -aL|grep a.out   //查看当前运行的轻量级进程

pstree -p 主线程id   //查看主线程和新线程的关系

ps stack 线程ID  //ps -aL获取线程ID,通过命令查看栈结构

gdb attach 主线程ID  //将进程附加到gdb调试器当中，查看是否创建了新线程

首先运行程序，然后重新开个窗口查看程序id，通过gdb attach附加到对应程序得gdb中

进入gdb后
info inferiors   //1.查看进程
info threads    //2.查看线程
bt           //3.查看线程栈结构
thread n（n代表第几个线程）    //4.切换线程

执行线程2的函数，指行完毕继续运行到断点处
1. 继续使某一线程运行：thread apply 1-n（第几个线程） n
2. 重新启动程序运行到断点处：r

只运行当前线程
1. 设置：set scheduler-locking on
2. 运行：n

所有线程并发执行
1. 设置：set scheduler-locking off
2. 运行：n
```

## <a id="4">cmake配置gdb</a>

```cpp
设置core文件大小
系统默认是不生成core文件的,只有手动输入ulimit -c xx命令才会产生core文件
ulimit -c 1024 设置core文件最大为1024k  
ulimit -c unlimited 不限制core文件大小
永久性的生成coredump文件,在/etc/bashrc或者~/.bashrc文件中加ulimit -c unlimited

设置core dump文件位置
vi /etc/sysctl.conf
修改（添加）如下两个变量
kernel.core_pattern =/var/core/core_%e_%p
kernel.core_uses_pid= 0
这里是改为生成目录在/var/core/，%e代表程序名称，%p是进程ID
如果想直接生成在可执行文件相同目录，前面不要加任何目录，直接
kernel.core_pattern =core_%e_%p

让修改生效
sysctl -p/etc/sysctl.conf

在CMakeList.txt中增加用于调试的编译选项
add_compile_options(-std=c++11 -pthread -g  -ggdb -O0 -Wall   -fstack-protector-all -march=native -fnon-call-exceptions)
其中-g表示使用debug编译,
-ggdb：在可执行文件中包含可供GDB使用的调试信息
-O0 表示编译时不优化,关闭所有优化选项
-Wall 开启大部分警告提示
-fstack-protector-all 保护栈信息
使用 -march=native，GCC会自动检测你的CPU支持的指令集。
-fnon-call-exceptions 产生的代码可供陷阱指令(如非法浮点运算和非法内存寻址)抛出异常，需要相关平台的运行时支持，并不普遍有效
```

## <a id="5">gcc编译选项</a>
参考连接：   
1.https://blog.csdn.net/rheostat/article/details/19811407     

```cpp
gcc编译选项
常用选项
-E：只进行预处理，不编译
-S：只编译，不汇编
-c：只编译、汇编，不链接
-g：包含调试信息
-I：指定include包含文件的搜索目录
-o：输出成指定文件名

高级选项
-v：详细输出编译过程中所采用的每一个选项
-C：预处理时保留注释信息
-ggdb：在可执行文件中包含可供GDB使用的调试信息
-fverbose-asm：在编译成汇编语言时，把C变量的名称作为汇编语言中的注释
-save-temps：自动输出预处理文件、汇编文件、对象文件，编译正常进行
-fsyntax-only：只测试源文件语法是否正确，不会进行任何编译操作
-ffreestanding：编译成独立程序，而非宿主程序

语言标准
-ansi：ANSI标准
-std=c99：C99标准
-std=gnu89：ISO/IEC 9899:1990 以及GNU扩充
-std=gnu99：ISO/IEC 9899:1999 以及GNU扩充
-trigraphs：支持ISO C三字符组

出错提示
-w：忽略所有警告
-Werror：不区分警告和错误，遇到任何警告都停止编译
-Wall：开启大部分警告提示
-Wshadow：某语句块作用域变量与更大作用域的另一变量同名时发出警告（此警告未包含在-Wall选项中，需单独开启）
-Wextra：对所有合法但值得怀疑的表达式发出警告

优化选项
-O0：关闭所有优化选项
-O1：第一级别优化，使用此选项可使可执行文件更小、运行更快，并不会增加太多编译时间，可以简写为-O
-O2：第二级别优化，采用了几乎所有的优化技术，使用此选项会延长编译时间
-O3：第三级别优化，在-O2的基础上增加了产生inline函数、使用寄存器等优化技术
-Os：此选项类似于-O2，作用是优化所占用的空间，但不会进行性能优化，常用于生成最终版本

自定义扩展名
-x：使用此选项可以指定自定义的源文件扩展名，类型有c、c-header、cpp-output、assembler、assembler-with-cpp、none
凡-x后面所列的所有文件都会被视为其指定的类型，要想改变类型可以再一次使用-x选项，或者使用-x none回到默认设置
示例：gcc -o test test.c -x assembler test.asm -x c test2.c

静态库的创建和使用
以创建静态库static_lib.a为例
编写C源文件static_lib.c，其中写入需要重复调用的函数，然后使用命令gcc -c static_lib.c生成目标文件static_lib.o
使用ar工具创建静态库，命令格式：ar rcs static_lib.a static_lib.o
编写C头文件static_lib.h，其中写入这些函数的原型声明
编写主函数app.c，引入头文件static_lib.h，这样就可以正常使用那些自定义的可复用函数了
使用命令gcc app.c -static ./static_lib.a -o app编译生成可执行文件app

动态库的创建和使用
以创建动态库share_lib.so为例
编写C源文件share_lib.c，写入需要重复调用的函数，然后使用命令gcc -shared -fPIC -o share_lib.so share_lib.c生成动态库文件share_lib.so
编写C头文件share_lib.h，写入函数的原型声明
编写主函数app.c，引入头文件share_lib.h，然后就可以调用在动态库中自定义的函数了
使用命令gcc app.c ./share_lib.so -o app编译生成可执行文件app
```

<article class="baidu_pl">
        <div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-a405391f94.css">
                <div id="content_views" class="htmledit_views">
                    <h2 id="toc_0.1" style="font-family:'Microsoft Yahei',sans-serif; margin:1em 0px 0px; padding:0.15em 0px; font-size:1.52em; color:rgb(255,221,85); background-color:rgb(17,34,51)"><a name="t0"></a><a name="t0"></a> GCC编译器</h2> 
<hr style="border-style:double none none; border-top-width:3px; border-top-color:rgb(0,51,85); width:1200px; margin:20px 0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> 
<h3 id="toc_0.1.1" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t1"></a><a name="t1"></a> 常用选项</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-E</code>：只进行预处理，不编译<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-S</code>：只编译，不汇编<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-c</code>：只编译、汇编，不链接<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-g</code>：包含调试信息<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-I</code>：指定include包含文件的搜索目录<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-o</code>：输出成指定文件名</p> 
<h3 id="toc_0.1.2" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t2"></a><a name="t2"></a> 高级选项</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-v</code>：详细输出编译过程中所采用的每一个选项<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-C</code>：预处理时保留注释信息<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-ggdb</code>：在可执行文件中包含可供<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">GDB</code>使用的调试信息<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-fverbose-asm</code>：在编译成汇编语言时，把C变量的名称作为汇编语言中的注释<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-save-temps</code>：自动输出预处理文件、汇编文件、对象文件，编译正常进行<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-fsyntax-only</code>：只测试源文件语法是否正确，不会进行任何编译操作<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-ffreestanding</code>：编译成独立程序，而非宿主程序</p> 
<h3 id="toc_0.1.3" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t3"></a><a name="t3"></a> 语言标准</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-ansi</code>：ANSI标准<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-std=c99</code>：C99标准<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-std=gnu89</code>：ISO/IEC 9899:1990 以及GNU扩充<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-std=gnu99</code>：ISO/IEC 9899:1999 以及GNU扩充<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-trigraphs</code>：支持ISO C三字符组</p> 
<h3 id="toc_0.1.4" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t4"></a><a name="t4"></a> 出错提示</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-w</code>：忽略所有警告<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Werror</code>：不区分警告和错误，遇到任何警告都停止编译<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Wall</code>：开启大部分警告提示<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Wshadow</code>：某语句块作用域变量与更大作用域的另一变量同名时发出警告（此警告未包含在<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Wall</code>选项中，需单独开启）<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Wextra</code>：对所有合法但值得怀疑的表达式发出警告</p> 
<h3 id="toc_0.1.5" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t5"></a><a name="t5"></a> 优化选项</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O0</code>：关闭所有优化选项<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O1</code>：第一级别优化，使用此选项可使可执行文件更小、运行更快，并不会增加太多编译时间，可以简写为<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O</code><br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O2</code>：第二级别优化，采用了几乎所有的优化技术，使用此选项会延长编译时间<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O3</code>：第三级别优化，在<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O2</code>的基础上增加了产生<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">inline</code>函数、使用寄存器等优化技术<br> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-Os</code>：此选项类似于<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-O2</code>，作用是优化所占用的空间，但不会进行性能优化，常用于生成最终版本</p> 
<h3 id="toc_0.1.6" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t6"></a><a name="t6"></a> 自定义扩展名</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> <code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-x</code>：使用此选项可以指定自定义的源文件扩展名，类型有<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">c</code>、<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">c-header</code>、<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">cpp-output</code>、<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">assembler</code>、<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">assembler-with-cpp</code>、<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">none</code></p> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> 凡<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-x</code>后面所列的所有文件都会被视为其指定的类型，要想改变类型可以再一次使用<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-x</code>选项，或者使用<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">-x none</code>回到默认设置</p> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> 示例：<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">gcc -o test test.c -x assembler test.asm -x c test2.c</code></p> 
<h3 id="toc_0.1.7" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t7"></a><a name="t7"></a> 静态库的创建和使用</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> 以创建静态库<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">static_lib.a</code>为例<br> </p> 
<ol style="margin:0.5em 0px 1em 1em; padding-left:0.5em; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写C源文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">static_lib.c</code>，其中写入需要重复调用的函数，然后使用命令<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">gcc -c static_lib.c</code>生成目标文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">static_lib.o</code></li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">使用<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">ar</code>工具创建静态库，命令格式：<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">ar rcs static_lib.a static_lib.o</code></li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写C头文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">static_lib.h</code>，其中写入这些函数的原型声明</li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写主函数<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">app.c</code>，引入头文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">static_lib.h</code>，这样就可以正常使用那些自定义的可复用函数了</li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">使用命令<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">gcc app.c -static ./static_lib.a -o app</code>编译生成可执行文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">app</code></li></ol> 
<h3 id="toc_0.1.8" style="font-family:'Microsoft Yahei',sans-serif; margin:0.9em 0px 0.4em; padding:0.15em 0px; font-size:1.22em; color:rgb(221,255,85); width:960px; background-color:rgb(17,34,51)"><a name="t8"></a><a name="t8"></a> 动态库的创建和使用</h3> 
<p style="margin-top:0.5em; margin-bottom:1em; padding-top:0px; padding-bottom:0px; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"> 以创建动态库<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">share_lib.so</code>为例<br> </p> 
<ol style="margin:0.5em 0px 1em 1em; padding-left:0.5em; color:rgb(202,211,214); font-family:'Trebuchet MS',Helvetica,SimSun,sans-serif; font-size:14px; line-height:21px; background-color:rgb(17,34,51)"><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写C源文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">share_lib.c</code>，写入需要重复调用的函数，然后使用命令<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">gcc -shared -fPIC -o share_lib.so share_lib.c</code>生成动态库文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">share_lib.so</code></li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写C头文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">share_lib.h</code>，写入函数的原型声明</li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">编写主函数<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">app.c</code>，引入头文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">share_lib.h</code>，然后就可以调用在动态库中自定义的函数了</li><li style="margin:0.3em auto; padding:0px; list-style-position:inside">使用命令<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">gcc app.c ./share_lib.so -o app</code>编译生成可执行文件<code style="padding:2px 4px; color:rgb(0,255,0); font-family:'Lucida Console','Courier New',Courier,monospace">app</code></li></ol> 
<div>
 <span style="font-family:Lucida Console,Courier New,Courier,monospace; color:#00ff00"><span style="font-size:14px; line-height:21px"><br> </span></span>
</div> 
<div>
 <span style="font-family:Lucida Console,Courier New,Courier,monospace; color:#00ff00"><span style="font-size:14px; line-height:21px"><br> </span></span>
</div> 
<div>
 <span style="font-family:Lucida Console,Courier New,Courier,monospace; color:#00ff00"><span style="font-size:14px; line-height:21px"><br> </span></span>
</div> 
<div>
 <span style="font-family:Lucida Console,Courier New,Courier,monospace; color:#00ff00"><span style="font-size:14px; line-height:21px"></span></span> 
 <div id="art" style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px; margin:15px"> 
  <span style="word-wrap:break-word; font-size:13px"><a target="_self" style="word-wrap:break-word; color:rgb(86,86,86)"><span style="word-wrap:break-word; text-decoration:underline"><span style="word-wrap:break-word">gcc</span></span></a>提供了大量的警告选项，对代码中可能存在的问题提出警告，通常可以使用-Wall来开启以下警告:<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Waddress -Warray-bounds (only with -O2) -Wc++0x-compat<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wchar-subscripts -Wimplicit-int -Wimplicit-function-declaration<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wcomment -Wformat -Wmain (only for C/ObjC and unless<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -ffreestanding) -Wmissing-braces -Wnonnull -Wparentheses<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wpointer-sign -Wreorder -Wreturn-type -Wsequence-point<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wsign-compare (only in C++) -Wstrict-aliasing -Wstrict-overflow=1<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wswitch -Wtrigraphs -Wuninitialized (only with -O1 and above)<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wunknown-pragmas -Wunused-function -Wunused-label -Wunused-value<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -Wunused-variable<br style="word-wrap:break-word"> unused-function:警告声明但是没有定义的static函数;<br style="word-wrap:break-word"> unused- label:声明但是未使用的标签;<br style="word-wrap:break-word"> unused-parameter:警告未使用的函数参数;<br style="word-wrap:break-word"> unused-variable:声明但是未使用的本地变量;<br style="word-wrap:break-word"> unused-value:计算了但是未使用的值;<br style="word-wrap:break-word"> format:printf和scanf这样的函数中的格式字符串的使用不当;<br style="word-wrap:break-word"> implicit-int:未指定类型;<br style="word-wrap:break-word"> implicit-function:函数在声明前使用;<br style="word-wrap:break-word"> char- subscripts:使用char类作为数组下标(因为char可能是有符号数);<br style="word-wrap:break-word"> missingbraces:大括号不匹配;<br style="word-wrap:break-word"> parentheses: 圆括号不匹配;<br style="word-wrap:break-word"> return-type:函数有无返回值以及返回值类型不匹配;<br style="word-wrap:break-word"> sequence-point:违反顺序点的代码,比如 a[i] = c[i++];<br style="word-wrap:break-word"> switch:switch语句缺少default或者switch使用枚举变量为索引时缺少某个变量的case;<br style="word-wrap:break-word"> strict- aliasing=n:使用n设置对指针变量指向的对象类型产生警告的限制程度,默认n=3;只有在-fstrict-aliasing设置的情况下有效;<br style="word-wrap:break-word"> unknow-pragmas:使用未知的#pragma指令;<br style="word-wrap:break-word"> uninitialized:使用的变量为初始化,只在-O2时有效;<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> 以下是在-Wall中不会激活的警告选项:<br style="word-wrap:break-word"> cast-align:当指针进行类型转换后有内存对齐要求更严格时发出警告;<br style="word-wrap:break-word"> sign- compare:当使用signed和unsigned类型比较时;<br style="word-wrap:break-word"> missing-prototypes:当函数在使用前没有函数原型时;<br style="word-wrap:break-word"> packed:packed 是gcc的一个扩展,是使结构体各成员之间不留内存对齐所需的<a target="_self" style="word-wrap:break-word; color:rgb(86,86,86)"><span style="word-wrap:break-word; text-decoration:underline"><span style="word-wrap:break-word">空间</span></span></a>,有时候会造成内存对齐的问题;<br style="word-wrap:break-word"> padded:也是gcc的扩展,使结构体成员之间进行内存对齐的填充,会造成结构体体积增大.<br style="word-wrap:break-word"> unreachable-code:有不会执行的代码时.<br style="word-wrap:break-word"> inline:当inline函数不再保持inline时 (比如对inline函数取地址);<br style="word-wrap:break-word"> disable-optimization:当不能执行指定的优化时.(需要太多时间或<a target="_self" style="word-wrap:break-word; color:rgb(86,86,86)"><span style="word-wrap:break-word; text-decoration:underline"><span style="word-wrap:break-word">系统</span></span></a>资源).<br style="word-wrap:break-word"> 可以使用 -Werror时所有的警告都变成错误,使出现警告时也停止编译.需要和指定警告的参数一起使用.<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> 优化:<br style="word-wrap:break-word"> gcc默认提供了5级优化选项的集合:<br style="word-wrap:break-word"> -O0:无优化(默认)<br style="word-wrap:break-word"> -O和-O1:使用能减少目标<a target="_self" style="word-wrap:break-word; color:rgb(86,86,86)"><span style="word-wrap:break-word; text-decoration:underline"><span style="word-wrap:break-word">文件</span></span></a>大小以及执行时间并且不会使编译时间明显增加的优化.在编译大型程序的时候会显著增加编译时内存的使用.<br style="word-wrap:break-word"> -O2: 包含-O1的优化并增加了不需要在目标文件大小和执行速度上进行折衷的优化.编译器不执行循环展开以及函数内联.此选项将增加编译时间和目标文件的执行性能.<br style="word-wrap:break-word"> -Os:专门优化目标文件大小,执行所有的不增加目标文件大小的-O2优化选项.并且执行专门减小目标文件大小的优化选项.<br style="word-wrap:break-word"> -O3: 打开所有-O2的优化选项并且增加 -finline-functions, -funswitch-loops,-fpredictive-commoning, -fgcse-after-reload and -ftree-vectorize优化选项.<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> -O1包含的选项-O1通常可以安全的和调试的选项一起使用:<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fauto-inc-dec -fcprop-registers -fdce -fdefer-pop -fdelayed-branch<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fdse -fguess-branch-probability -fif-conversion2 -fif-conversion<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -finline-small-functions -fipa-pure-const -fipa-reference<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fmerge-constants -fsplit-wide-types -ftree-ccp -ftree-ch<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -ftree-copyrename -ftree-dce -ftree-dominator-opts -ftree-dse<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -ftree-fre -ftree-sra -ftree-ter -funit-at-a-time<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> 以下所有的优化选项需要在名字前加上-f,如果不需要此选项可以使用-fno-前缀<br style="word-wrap:break-word"> defer-pop:延迟到只在必要时从函数参数栈中pop参数;<br style="word-wrap:break-word"> thread- jumps:使用跳转线程优化,避免跳转到另一个跳转;<br style="word-wrap:break-word"> branch-probabilities:分支优化;<br style="word-wrap:break-word"> cprop- registers:使用寄存器之间copy-propagation传值;<br style="word-wrap:break-word"> guess-branch-probability:分支预测;<br style="word-wrap:break-word"> omit- frame-pointer:可能的情况下不产生栈帧;<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> -O2:以下是-O2在-O1基础上增加的优化选项:<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -falign-functions&nbsp; -falign-jumps -falign-loops&nbsp; -falign-labels<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fcaller-saves -fcrossjumping -fcse-follow-jumps&nbsp; -fcse-skip-blocks<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fdelete-null-pointer-checks -fexpensive-optimizations -fgcse<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fgcse-lm -foptimize-sibling-calls -fpeephole2 -fregmove<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -freorder-blocks&nbsp; -freorder-functions -frerun-cse-after-loop<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fsched-interblock&nbsp; -fsched-spec -fschedule-insns<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -fschedule-insns2 -fstrict-aliasing -fstrict-overflow -ftree-pre<br style="word-wrap:break-word"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -ftree-vrp<br style="word-wrap:break-word"> cpu架构的优化选项,通常是-mcpu(将被取消);-march,-mtune<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> Debug选项:<br style="word-wrap:break-word"> 在 gcc编译源代码时指定-g选项可以产生带有调试信息的目标代码,gcc可以为多个不同平台上帝不同调试器提供调试信息,默认gcc产生的调试信息是为 gdb使用的,可以使用-gformat 指定要生成的调试信息的格式以提供给其他平台的其他调试器使用.常用的格式有<br style="word-wrap:break-word"> -ggdb:生成gdb专用的调试信息,使用最适合的格式(DWARF 2,stabs等)会有一些gdb专用的扩展,可能造成其他调试器无法运行.<br style="word-wrap:break-word"> -gstabs:使用 stabs格式,不包含gdb扩展,stabs常用于BSD系统的DBX调试器.<br style="word-wrap:break-word"> -gcoff:产生COFF格式的调试信息,常用于System V下的SDB调试器;<br style="word-wrap:break-word"> -gxcoff:产生XCOFF格式的调试信息,用于IBM的RS/6000下的DBX调试器;<br style="word-wrap:break-word"> -gdwarf- 2:产生DWARF version2 的格式的调试信息,常用于IRIXX6上的DBX调试器.GCC会使用DWARF version3的一些特性.<br style="word-wrap:break-word"> 可以指定调试信息的等级:在指定的调试格式后面加上等级:<br style="word-wrap:break-word"> 如: -ggdb2 等,0代表不产生调试信息.在使用-gdwarf-2时因为最早的格式为-gdwarf2会造成混乱,所以要额外使用一个-glevel来指定调试信息的等级,其他格式选项也可以另外指定等级.<br style="word-wrap:break-word"> <br style="word-wrap:break-word"> gcc可以使用-p选项指定生成信息以供porf使用.</span>
 </div> 
 <h3 style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"><a name="t9"></a><a name="t9"></a> <a target="_blank" name="t0" style="word-wrap:break-word; color:rgb(86,86,86)"></a><br style="word-wrap:break-word"> </h3> 
 <h3 style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"><a name="t10"></a><a name="t10"></a> <a target="_blank" name="t1" style="word-wrap:break-word; color:rgb(86,86,86)"></a><br style="word-wrap:break-word"> </h3> 
 <h3 style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"><a name="t11"></a><a name="t11"></a> <a target="_blank" name="t2" style="word-wrap:break-word; color:rgb(86,86,86)"></a><br style="word-wrap:break-word"> </h3> 
 <h3 style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"><a name="t12"></a><a name="t12"></a> <a target="_blank" name="t3" style="word-wrap:break-word; color:rgb(86,86,86)"></a><span style="word-wrap:break-word; font-size:13px">GCC常用选项</span></h3> 
 <div class="table-box"><table border="1" cellpadding="4" cellspacing="1" style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:12px; line-height:26px; width:1062px"><tbody style="word-wrap:break-word"></tbody></table></div> 
 <div class="table-box"><table border="1" style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:12px; line-height:26px"><tbody style="word-wrap:break-word"><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">选项</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">含义</span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">--help&nbsp;<br style="word-wrap:break-word"> --target-help</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">显示 gcc 帮助说明。‘target-help’是显示目标机器特定的命令行选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">--version</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">显示 gcc 版本号和版权信息 。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-o&nbsp;<span style="word-wrap:break-word">outfile</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">输出到指定的文件。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-x&nbsp;<span style="word-wrap:break-word">language</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">指明使用的编程语言。允许的语言包括：c c++ assembler none 。 ‘none’意味着恢复默认行为，即根据文件的扩展名猜测源文件的语言。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-v</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">打印较多信息，显示编译器调用的程序。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-###</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">与 -v 类似，但选项被引号括住，并且不执行命令。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-E</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">仅作预处理，不进行编译、汇编和链接。如上图所示。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-S</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">仅编译到汇编语言，不进行汇编和链接。如上图所示。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-c</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">编译、汇编到目标代码，不进行链接。如上图所示。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-pipe</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">使用管道代替临时文件。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-combine</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">将多个源文件一次性传递给汇编器。</span></td></tr></tbody></table></div> 
 <span style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px; font-size:13px"><a target="_blank" name="GCC_OTHER_ARGS" style="word-wrap:break-word; color:rgb(86,86,86)"></a></span>
 <span style="color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"></span> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> &nbsp;</p> 
 <h3 style="word-wrap:break-word; margin:0px; padding:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"><a name="t13"></a><a name="t13"></a> <a target="_blank" name="t4" style="word-wrap:break-word; color:rgb(86,86,86)"></a><span style="word-wrap:break-word; font-size:13px">3 其他GCC选项</span></h3> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> <span style="word-wrap:break-word; font-size:13px">更多有用的GCC选项：</span></p> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> &nbsp;</p> 
 <div class="table-box"><table border="1" style="word-wrap:break-word; color:rgb(102,102,102); font-family:宋体,Arial; font-size:12px; line-height:26px"><tbody style="word-wrap:break-word"><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">命令</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">描述</span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-l&nbsp;<span style="word-wrap:break-word">library</span><br style="word-wrap:break-word"> -l<span style="word-wrap:break-word">library</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">进行链接时搜索名为library的库。<br style="word-wrap:break-word"> 例子： $ gcc test.c -lm -o test</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-I<span style="word-wrap:break-word">dir</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">把<span style="word-wrap:break-word">dir</span>加入到搜索头文件的路径列表中。<br style="word-wrap:break-word"> 例子： $ gcc test.c -I../inc -o test</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-L<span style="word-wrap:break-word">dir</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">把<span style="word-wrap:break-word">dir</span>加入到搜索库文件的路径列表中。<br style="word-wrap:break-word"> 例子： $ gcc -I/home/foo -L/home/foo -ltest test.c -o test</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-D<span style="word-wrap:break-word">name</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">预定义一个名为<span style="word-wrap:break-word">name</span>的宏，值为1。<br style="word-wrap:break-word"> 例子： $ gcc -DTEST_CONFIG test.c -o test</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-D<span style="word-wrap:break-word">name</span>=<span style="word-wrap:break-word">definition</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">预定义名为<span style="word-wrap:break-word">name</span>，值为<span style="word-wrap:break-word">definition</span>的宏。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-ggdb&nbsp;<br style="word-wrap:break-word"> -ggdb<span style="word-wrap:break-word">level</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">为调试器 gdb 生成调试信息。<span style="word-wrap:break-word">level</span>可以为1，2，3，默认值为2。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-g&nbsp;<br style="word-wrap:break-word"> -g<span style="word-wrap:break-word">level</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">生成操作系统本地格式的调试信息。-g 和 -ggdb 并不太相同， -g 会生成 gdb 之外的信息。<span style="word-wrap:break-word">level</span>取值同上。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-s</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">去除可执行文件中的符号表和重定位信息。用于减小可执行文件的大小。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-M</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">告 诉预处理器输出一个适合make的规则，用于描述各目标文件的依赖关系。对于每个源文件，预处理器输出 一个make规则，该规则的目标项(target)是源文件对应的目标文件名，依赖项(dependency)是源文件中 `#include引用的所有文件。生成的规则可以是单行，但如果太长，就用`/'-换行符续成多行。规则 显示在标准输出，不产生预处理过的C程序。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-C</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">告诉预处理器不要丢弃注释。配合`-E'选项使用。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-P</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">告诉预处理器不要产生`#line'命令。配合`-E'选项使用。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-static</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">在支持动态链接的系统上，阻止连接共享库。该选项在其它系统上无效。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-nostdlib</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">不连接系统标准启动文件和标准库文件，只把指定的文件传递给连接器。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">Warnings</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wall</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">会打开一些很有用的警告选项，建议编译时加此选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-W&nbsp;<br style="word-wrap:break-word"> -Wextra</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">打印一些额外的警告信息。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-w</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">禁止显示所有警告信息。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wshadow</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当一个局部变量遮盖住了另一个局部变量，或者全局变量时，给出警告。很有用的选项，建议打开。 -Wall 并不会打开此项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wpointer-arith</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">对函数指针或者void *类型的指针进行算术操作时给出警告。也很有用。 -Wall 并不会打开此项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wcast-qual</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当强制转化丢掉了类型修饰符时给出警告。 -Wall 并不会打开此项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Waggregate-return</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果定义或调用了返回结构体或联合体的函数，编译器就发出警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Winline</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">无论是声明为 inline 或者是指定了-finline-functions 选项，如果某函数不能内联，编译器都将发出警告。如果你的代码含有很多 inline 函数的话，这是很有用的选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Werror</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">把警告当作错误。出现任何警告就放弃编译。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wunreachable-code</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果编译器探测到永远不会执行到的代码，就给出警告。也是比较有用的选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wcast-align</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">一旦某个指针类型强制转换导致目标所需的地址对齐增加时，编译器就发出警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wundef</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当一个没有定义的符号出现在 #if 中时，给出警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wredundant-decls</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果在同一个可见域内某定义多次声明，编译器就发出警告，即使这些重复声明有效并且毫无差别。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">Optimization</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-O0</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">禁止编译器进行优化。默认为此项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-O&nbsp;<br style="word-wrap:break-word"> -O1</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">尝试优化编译时间和可执行文件大小。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-O2</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">更多的优化，会尝试几乎全部的优化功能，但不会进行“空间换时间”的优化方法。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-O3</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">在 -O2 的基础上再打开一些优化选项：-finline-functions， -funswitch-loops 和 -fgcse-after-reload 。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Os</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">对生成文件大小进行优化。它会打开 -O2 开的全部选项，除了会那些增加文件大小的。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-finline-functions</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">把所有简单的函数内联进调用者。编译器会探索式地决定哪些函数足够简单，值得做这种内联。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fstrict-aliasing</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">施加最强的别名规则（aliasing rules）。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">Standard</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-ansi</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">支持符合ANSI标准的C程序。这样就会关闭GNU C中某些不兼容ANSI C的特性。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-std=c89&nbsp;<br style="word-wrap:break-word"> -iso9899:1990</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">指明使用标准 ISO C90 作为标准来编译程序。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-std=c99&nbsp;<br style="word-wrap:break-word"> -std=iso9899:1999</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">指明使用标准 ISO C99 作为标准来编译程序。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-std=c++98</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">指明使用标准 C++98 作为标准来编译程序。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-std=gnu9x&nbsp;<br style="word-wrap:break-word"> -std=gnu99</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">使用 ISO C99 再加上 GNU 的一些扩展。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fno-asm</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">不把asm, inline或typeof当作关键字，因此这些词可以用做标识符。用 __asm__， __inline__和__typeof__能够替代它们。 `-ansi' 隐含声明了`-fno-asm'。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fgnu89-inline</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">告诉编译器在 C99 模式下看到 inline 函数时使用传统的 GNU 句法。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">C options</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fsigned-char&nbsp;<br style="word-wrap:break-word"> -funsigned-char</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">把char定义为有/无符号类型，如同signed char/unsigned char。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-traditional</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">尝试支持传统C编译器的某些方面。详见GNU C手册。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fno-builtin&nbsp;<br style="word-wrap:break-word"> -fno-builtin-function</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">不接受没有 __builtin_ 前缀的函数作为内建函数。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-trigraphs</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">支持ANSI C的三联符（ trigraphs）。`-ansi'选项隐含声明了此选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fsigned-bitfields&nbsp;<br style="word-wrap:break-word"> -funsigned-bitfields</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果没有明确声明`signed'或`unsigned'修饰符，这些选项用来定义有符号位域或无符号位域。缺省情况下，位域是有符号的，因为它们继承的基本整数类型，如int，是有符号数。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wstrict-prototypes</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果函数的声明或定义没有指出参数类型，编译器就发出警告。很有用的警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wmissing-prototypes</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果没有预先声明就定义了全局函数，编译器就发出警告。即使函数定义自身提供了函数原形也会产生这个警告。这个选项 的目的是检查没有在头文件中声明的全局函数。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wnested-externs</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果某extern声明出现在函数内部，编译器就发出警告。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">C++ options</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-ffor-scope</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">从头开始执行程序，也允许进行重定向。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-fno-rtti</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">关闭对 dynamic_cast 和 typeid 的支持。如果你不需要这些功能，关闭它会节省一些空间。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wctor-dtor-privacy</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当一个类没有用时给出警告。因为构造函数和析构函数会被当作私有的。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wnon-virtual-dtor</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当一个类有多态性，而又没有虚析构函数时，发出警告。-Wall会开启这个选项。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wreorder</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果代码中的成员变量的初始化顺序和它们实际执行时初始化顺序不一致，给出警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Wno-deprecated</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">使用过时的特性时不要给出警告。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-Woverloaded-virtual</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">如果函数的声明隐藏住了基类的虚函数，就给出警告。</span></td></tr><tr bgcolor="#c0c0c0" style="word-wrap:break-word"><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">Machine Dependent Options (Intel)</span></th><th style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px"><br style="word-wrap:break-word"> </span></th></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-mtune=<span style="word-wrap:break-word">cpu-type</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">为指定类型的 CPU 生成代码。<span style="word-wrap:break-word">cpu-type</span>可以是：i386，i486，i586，pentium，i686，pentium4 等等。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-msse&nbsp;<br style="word-wrap:break-word"> -msse2&nbsp;<br style="word-wrap:break-word"> -mmmx&nbsp;<br style="word-wrap:break-word"> -mno-sse&nbsp;<br style="word-wrap:break-word"> -mno-sse2&nbsp;<br style="word-wrap:break-word"> -mno-mmx</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">使用或者不使用MMX，SSE，SSE2指令。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-m32&nbsp;<br style="word-wrap:break-word"> -m64</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">生成32位/64位机器上的代码。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-mpush-args&nbsp;<br style="word-wrap:break-word"> -mno-push-args</span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">（不）使用 push 指令来进行存储参数。默认是使用。</span></td></tr><tr style="word-wrap:break-word"><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">-mregparm=<span style="word-wrap:break-word">num</span></span></td><td style="word-wrap:break-word; margin:0px; padding:0px"><span style="word-wrap:break-word; font-size:13px">当传递整数参数时，控制所使用寄存器的个数。<br style="word-wrap:break-word"> </span></td></tr></tbody></table></div> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> 另外：</p> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> <span style="word-wrap:break-word; color:rgb(255,0,0)">当静态库和动态库同名时， gcc命令将优先使用动态库。</span></p> 
 <p style="word-wrap:break-word; margin-top:5px; margin-bottom:5px; padding-top:0px; padding-bottom:0px; color:rgb(102,102,102); font-family:宋体,Arial; line-height:26px"> <span style="word-wrap:break-word; color:rgb(255,0,0)">-shared 该选项指定生成动态连接库</span>（让连接器生成T类型的导出符号表，有时候也生成弱连接W类型的导出符号），不用该标志外部程序无法连接。相当于一个可执行文件<br style="word-wrap:break-word"> l&nbsp;<span style="word-wrap:break-word; color:rgb(255,0,0)">-fPIC：表示编译为位置独立的代码，</span>不用此选项的话编译后的代码是位置相关的所以动态载入时是通过代码拷贝的方式来满足不同进程的需要，而不能达到真正代码段共享的目的。<br style="word-wrap:break-word"> l -L.：表示要连接的库在当前目录中<br style="word-wrap:break-word"> l -ltest：编译器查找动态连接库时有隐含的命名规则，即在给出的名字前面加上lib，后面加上.so来确定库的名称<br style="word-wrap:break-word"> l LD_LIBRARY_PATH：这个环境变量指示动态连接器可以装载动态库的路径。<br style="word-wrap:break-word"> l 当然如果有root权限的话，可以修改/etc/ld.so.conf文件，然后调用 /sbin/ldconfig来达到同样的目的，不过如果没有root权限，那么只能采用输出LD_LIBRARY_PATH的方法了。调用动态库的时候 有几个问题会经常碰到，有时，明明已经将库的头文件所在目录 通过 “-I” include进来了，库所在文件通过 “-L”参数引导，并指定了“-l”的库名，但通过ldd命令察看时，就是死活找不到你指定链接的so文件，这时你要作的就是通过修改 LD_LIBRARY_PATH或者/etc/ld.so.conf文件来指定动态库的目录。通常这样做就可以解决库无法链接的问题了。</p> 
 <br> 
</div>
</div><div><div></div></div>
</div>
</article>

## links
  * [目录](<目录.md>)